<!DOCTYPE html>
<html lang=en>
<head>
  <meta charset="utf-8">
  <title></title>
  <style>
    html, body {
      margin:0;
      padding:0;
      overflow:hidden;
      height: 100%;
      background:#000;
      text-align:center;
    }
    body * {
      -webkit-touch-callout: none;
      -webkit-user-select: none;
      -khtml-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
    }
    main {
     position:absolute;
     width:100vmin;
     height:100vmin;
     left:50%;
     top:50%;
     margin-left:-50vmin;
     margin-top:-50vmin;
     color:#fff;
    }
    p {
      font-family: "Courier", monospace;
      font-size: 24vmin;
      position:absolute;
      margin: 0;     
      margin-top:38vmin;
    }
    svg {
      position: absolute;
      top:0;
      left:0;
      width:100%;
      height: 100%;
    }
    span.red{
      color: #fee;    
      animation: glow .5s infinite alternate;
    }
    span.visible{
      color:green;
    }

    svg use #red{
      animation: glow .5s infinite alternate;
    }

    @keyframes glow {
      to {
        text-shadow: 0px 0px 15px rgba(255, 0, 0, 0.75);
      }
    }
  </style>  
</head>
<body>
<main>
<?xml version="1.0"?>
<svg
  xmlns="http://www.w3.org/2000/svg" 
  width="100"
  height="100"
  viewbox="0 0 100 100">

  <defs>
    <radialGradient
      id="bump"
      cx="50%"
      cy="50%"
      r="100%"
      fx="25%"
      fy="25%">
      <stop offset="0%" style="stop-color:#ccc" />
      <stop offset="100%" style="stop-color:#666" />
    </radialGradient>
    <radialGradient
      id="pulse"
      cx="50%"
      cy="50%"
      r="100%"
      fx="25%"
      fy="25%">
      <stop offset="0%" style="stop-color:#f00" />
      <stop offset="100%" style="stop-color:#900" />
    </radialGradient>
    <circle
      id="line"
      cx="15"
      cy="15"
      r="15"
      stroke="#666"
      stroke-width="1"
      fill="none"
    />
    <circle
      id="fill"
      cx="15"
      cy="15"
      r="15"
      fill="url(#bump)"
    />
    <circle
      id="red"
      cx="15"
      cy="15"
      r="15"
      fill="url(#pulse)"
    />
    <g
      id="*"
      width="80"
      height="130"
      transform="scale(0.1)"
      >
      <use x=   "0"   y="0" xlink:href="#line"/>
      <use x=   "0"  y="50" xlink:href="#line"/>
      <use x=   "0" y="100" xlink:href="#line"/>
      <use x=  "50"   y="0" xlink:href="#line"/>
      <use x=  "50"  y="50" xlink:href="#line"/>
      <use x=  "50" y="100" xlink:href="#line"/>
    </g>
    <g
      id="**"
      width="200"
      height="130"
      transform="scale(0.1)"
      >
      <use x=   "0"   y="0" xlink:href="#line"/>
      <use x=   "0"  y="50" xlink:href="#line"/>
      <use x=   "0" y="100" xlink:href="#line"/>
      <use x=  "50"   y="0" xlink:href="#line"/>
      <use x=  "50"  y="50" xlink:href="#line"/>
      <use x=  "50" y="100" xlink:href="#line"/>
      <use x= "150"   y="0" xlink:href="#line"/>
      <use x= "150"  y="50" xlink:href="#line"/>
      <use x= "150" y="100" xlink:href="#line"/>
      <use x= "200"   y="0" xlink:href="#line"/>
      <use x= "200"  y="50" xlink:href="#line"/>
      <use x= "200" y="100" xlink:href="#line"/>
    </g>
    <g
      id="CO"
      width="200"
      height="130"
      transform="scale(0.1)"
      >
      <use x=   "0"   y="0" xlink:href="#fill"/>
      <use x=   "0"  y="50" xlink:href="#line"/>
      <use x=   "0" y="100" xlink:href="#line"/>
      <use x=  "50"   y="0" xlink:href="#fill"/>
      <use x=  "50"  y="50" xlink:href="#line"/>
      <use x=  "50" y="100" xlink:href="#line"/>

      <use x= "150"   y="0" xlink:href="#fill"/>
      <use x= "150"  y="50" xlink:href="#line"/>
      <use x= "150" y="100" xlink:href="#fill"/>
      <use x= "200"   y="0" xlink:href="#line"/>
      <use x= "200"  y="50" xlink:href="#fill"/>
      <use x= "200" y="100" xlink:href="#line"/>
    </g>
    <g
      id="M"
      width="80"
      height="130"
      transform="scale(0.1)"
      >
      <use x=   "0"   y="0" xlink:href="#fill"/>
      <use x=   "0"  y="50" xlink:href="#line"/>
      <use x=   "0" y="100" xlink:href="#fill"/>
      <use x=  "50"   y="0" xlink:href="#fill"/>
      <use x=  "50"  y="50" xlink:href="#line"/>
      <use x=  "50" y="100" xlink:href="#line"/>
    </g>
    <g
      id="P"
      width="80"
      height="130"
      transform="scale(0.1)"
      >
      <use x=   "0"   y="0" xlink:href="#fill"/>
      <use x=   "0"  y="50" xlink:href="#fill"/>
      <use x=   "0" y="100" xlink:href="#fill"/>
      <use x=  "50"   y="0" xlink:href="#fill"/>
      <use x=  "50"  y="50" xlink:href="#line"/>
      <use x=  "50" y="100" xlink:href="#line"/>
    </g>
    <g
      id="L"
      width="80"
      height="130"
      transform="scale(0.1)"
      >
      <use x=   "0"   y="0" xlink:href="#fill"/>
      <use x=   "0"  y="50" xlink:href="#fill"/>
      <use x=   "0" y="100" xlink:href="#fill"/>
      <use x=  "50"   y="0" xlink:href="#line"/>
      <use x=  "50"  y="50" xlink:href="#line"/>
      <use x=  "50" y="100" xlink:href="#line"/>
    </g>
    <g
      id="E"
      width="80"
      height="130"
      transform="scale(0.1)"
      >
      <use x=   "0"   y="0" xlink:href="#fill"/>
      <use x=   "0"  y="50" xlink:href="#line"/>
      <use x=   "0" y="100" xlink:href="#line"/>
      <use x=  "50"   y="0" xlink:href="#line"/>
      <use x=  "50"  y="50" xlink:href="#fill"/>
      <use x=  "50" y="100" xlink:href="#line"/>
    </g>
    <g
      id="X"
      width="80"
      height="130"
      transform="scale(0.1)"
      >
      <use x=   "0"   y="0" xlink:href="#red"/>
      <use x=   "0"  y="50" xlink:href="#red"/>
      <use x=   "0" y="100" xlink:href="#red"/>
      <use x=  "50"   y="0" xlink:href="#red"/>
      <use x=  "50"  y="50" xlink:href="#red"/>
      <use x=  "50" y="100" xlink:href="#red"/>
    </g>
    <filter id="turbulence" filterUnits="userSpaceOnUse" x="0" y="0" width="100" height="100">
      <feTurbulence
       type="fractalNoise"
       baseFrequency="1 1"
       numOctaves="1"
       seed="0"
       stitchTiles="noStitch"
      in="SourceGraphic">
        <!-- <animate
         attributeName="seed"
         calcMode="linear"
         values="0;100"
         begin="0s"
         dur="1s"
         repeatCount="indefinite"
        /> -->
      </feTurbulence>
      <feColorMatrix type="saturate" values="0" in="f1">
    </filter>
  </defs>

  <rect filter="url(#turbulence)" width="100" height="100" opacity="0.3" />
  <g transform="translate(3.25,66.67) scale(0.96)">
    <use id="cell_CO" x= "0" y="0" xlink:href="#**"/>
    <use id="cell_M"  x= "30" y="0" xlink:href="#*"/>
    <use id="cell_P"  x= "45" y="0" xlink:href="#*"/>
    <use id="cell_L"  x= "60" y="0" xlink:href="#*"/>
    <use id="cell_E"  x= "75" y="0" xlink:href="#*"/>
    <use id="cell_X"  x= "90" y="0" xlink:href="#*"/>
  </g>
</svg>

<p><span id="SI">CO</span><span>M</span><span>P</span><span>L</span><span>E</span><span class="red">X</span></p>

</main>

<script>
;(function () {
  var xlinkNS = "http://www.w3.org/1999/xlink"
  var body = document.body // querySelector("p")
  var SI = document.querySelector("#SI")
  var SICell = document.querySelector("#cell_CO")
  var SIOn = false
  var current
    , cell

  body.onmousedown = body.ontouchstart = activateLetter


  function activateLetter(event) {
    var target = event.target
    if (target.nodeName.toLowerCase() !== "span") {
      return
    } 

    if (target !== SI && SIOn) {
      hideSI()
      // SIOn may be true if: co is showing, click on SI
      // Otherwise SIOn is false
    }

    rolloverLetter(event, true)

    function rolloverLetter(event, isClick) {
      var target = event.target
      if (target.nodeName.toLowerCase() !== "span") {
        return
      } 

      if (!isClick && target === current) {
        // We're just moving over the same letter (group)
        return
      } else if (cell) {
        // We've rolled to a new letter (group)
        hideCell(event, true)
      }

      showCell(target)
      
      function showCell(target) {
        var text = target.innerHTML
        var id ="#"+text
        current = target
        cell = document.querySelector("#cell_" + text)
        cell.setAttributeNS(xlinkNS, "xlink:href", id)
    
        body.onmousemove = body.ontouchmove = rolloverLetter
        body.onmouseup = body.ontouchend = hideCell
      }

      function hideCell(event, isRollover) {
         if (cell === SICell && isRollover) {
           hideSI()
         } else {
           cell.setAttributeNS(xlinkNS, "xlink:href", "#*")
         } 

         if (target === SI) {
          toggleSI(isRollover)

        } else {
          SIOn = false
          current = null
          cell = null
        }

        body.onmouseup = body.ontouchend = body.onmousemove = body.ontouchmove = null
      }

      function toggleSI(isRollover) {
        if (SIOn) {
          if (isRollover) {
            // Called immediately after click
          } else {
            // Only true if co was already showing, the click was on
            // SI and it hasn't moved off, and the mouse has just been
            // released
            hideSI()
            current = null
            cell = null
          }
          return
        } else {
          SICell.setAttributeNS(xlinkNS, "xlink:href", "#CO")

          if (!isRollover) {
            SIOn = true
            cell = false
          }
          
          // console.log("showing")
          // current = null // so we can toggle this off again
        }
      }
    }

    function hideSI() {
      SIOn = false
      SICell.setAttributeNS(xlinkNS, "xlink:href", "#**")
    }
  }
})()
</script>
</body>
</html>
